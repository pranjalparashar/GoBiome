Bangle.setLCDPower(1);
Bangle.setLCDTimeout(0);

g.clear();
//g.setColor(1,1,1);



g.setFont("Vector",40);
//g.drawString("Hello",20,20);

var solid_block = {
        width : 51, height : 8, bpp : 01,
        transparent : 0,
        buffer : E.toArrayBuffer(atob("/////////////////////////////////////////////////////////////////////////////////w=="))
    };

var n=0;
function drawSlice(from,to) {
  var a, res = 35;
  var x = 88, y = 236, r1 = 106, r2 = 108;
  var poly = [];
  for (var i=from*res;i<to*res;i++) {
    a = i*Math.PI*2/res;
    poly.push(x+r2*Math.sin(a), y+r2*Math.cos(a));
    poly.unshift(x+r1*Math.sin(a), y+r1*Math.cos(a));
  }
  a = to*Math.PI*2;
  poly.push(x+r2*Math.sin(a), y+r2*Math.cos(a));
  poly.unshift(x+r1*Math.sin(a), y+r1*Math.cos(a));
  g.fillPoly(poly);
}
function draw() {
  n += 10;
  if (n>=1) n=0;
  g.setColor(0,1,0);
  drawSlice(n,1);

}

var gardening = [
  {fill: "#ffffff", points: [10.926,3.333,5.025,0.055,4.298,0.31,1.058,7.165,0.014,12.241,0.352,15.737,1.761,18.711,4.918,21.154,9.915,21.422,15.377,29.738,16.354,29.561,11.01,21.042,13.352,19.6,16.057,15.406,16.286,11.899,15.311,8.558,10.926,3.33]}
];
var social = [
  {fill: "#000000", points: [33.319,12.541,26.681,12.44,23.6,14.199,25.59,15.689,26.457,18.25,26.457,29.052,27.085,29.656,29.072,29.656,29.575,22.973,30.078,29.656,32.693,29.051,33.195,16.304,33.697,21.157,35.982,20.551,35.387,13.938,33.319,12.541]},
  {fill: "#000000", points: [29.575,10.769,31.411,10.051,32.214,8.226,31.434,6.424,29.575,5.684,27.739,6.402,26.936,8.226,27.715,10.029,29.575,10.769]},
  {fill: "#000000", points: [21.934,14.861,16.148,14.861,13.834,15.705,12.636,18.25,12.636,22.976,13.265,23.578,14.921,23.578,14.921,19.209,15.887,19.022,15.926,31.473,16.555,32.077,18.542,32.077,19.044,25.395,19.547,32.077,22.162,31.472,22.664,18.726,23.167,23.578,25.452,22.972,25.452,18.245,24.536,15.972,21.934,14.861]},
  {fill: "#000000", points: [19.044,13.19,20.88,12.472,21.683,10.648,20.903,8.845,19.044,8.105,17.208,8.823,16.405,10.648,17.185,12.45,19.044,13.19]},
  {fill: "#000000", points: [14.488,14.199,11.403,12.44,4.769,12.54,2.722,13.909,2.105,20.552,2.734,21.157,4.39,21.157,4.39,16.787,5.395,16.788,5.395,29.051,6.024,29.656,8.011,29.656,8.513,22.973,9.016,29.656,11.631,29.05,11.631,18.245,12.361,15.879,14.488,14.199]},
  {fill: "#000000", points: [8.513,10.769,10.349,10.051,11.152,8.226,10.372,6.424,8.513,5.684,6.677,6.402,5.874,8.226,6.654,10.029,8.513,10.769]},
  {fill: "#000000", points: [-23.611,124.365,-26.138,124.131,-26.661,122.773,-26.137,121.417,-23.611,121.181,-23.611,121.921,-24.646,121.584,-25.704,122.774,-25.421,123.647,-23.611,123.625]},
  {fill: "#000000", points: [-10.669,120.014,-11.63,120.124,-11.807,121.97,-12.666,121.97,-12.666,119.282,-10.672,119.235]},
  {fill: "#000000", points: [-6.034,127.633,-8.045,127.88,-6.163,128.16,-6.163,128.821,-7.381,129.054,-8.92,127.644,-7.43,126.231,-6.034,127.633]},
  {fill: "#000000", points: [-6.918,127.348,-7.433,126.805,-8.034,127.348]},
  {fill: "#000000", points: [-2.96,120.913,-3.39,121.53,-2.512,120.913]},
  {fill: "#000000", points: [-1.648,120.589,-1.648,122.123,-3.429,122.191,-4.367,121.316,-2.513,120.403,-4.131,120.161,-4.131,119.506,-1.972,119.657,-1.649,120.589]},
  {fill: "#000000", points: [57.432,120.502,57.432,121.265,58.318,121.265,58.318,121.879,57.432,121.879,58.241,123.953,56.782,123.741,56.146,121.879,56.571,120.502]},
  {fill: "#000000", points: [47.344,126.718,45.333,126.965,47.215,127.245,47.215,127.906,45.997,128.139,44.458,126.729,45.948,125.316,47.344,126.718]},
  {fill: "#000000", points: [46.461,126.433,45.945,125.89,45.344,126.433]},
  {fill: "#000000", points: [32.588,125.164,32.588,123.724,33.452,123.724,33.452,127.46,30.888,127.134,30.889,125.1,32.588,125.164]},
  {fill: "#000000", points: [32.023,126.906,32.588,126.119,32.023,125.332,31.458,126.119,32.023,126.906]},
  {fill: "#000000", points: [32.693,123.094,33.261,122.306,32.693,121.519,32.122,122.306,32.693,123.094]},
  {fill: "#000000", points: [32.122,121.352,33.829,121.289,33.828,123.322,31.264,123.648,31.264,119.912,32.122,119.912]},
  {fill: "#000000", points: [35.649,119.282,36.507,119.282,37.231,121.106,37.846,119.282,38.704,119.282,37.176,122.851,36.079,123.032,36.847,122.074]},
  {fill: "#000000", points: [201.679,73.702,200.667,75.202,201.679,75.202]},
  {fill: "#000000", points: [201.525,72.942,202.551,72.942,203.064,75.872,201.679,76.524,201.679,75.872,200.091,75.872,200.091,75.079]},
  {fill: "#000000", points: [109.426,83.407,109.426,81.766,110.29,81.766,110.693,83.873,111.269,81.766,112.127,81.766,112.127,84.454,110.376,84.523,109.426,83.407]},
  {fill: "#000000", points: [130.202,83.871,129.242,83.981,129.064,85.827,128.205,85.827,128.205,83.139,130.199,83.092]},
  {fill: "#000000", points: [157.679,85.425,158.246,84.638,157.679,83.851,157.108,84.638,157.679,85.425]},
  {fill: "#000000", points: [157.108,83.684,158.814,83.621,158.813,85.654,156.25,85.979,156.25,82.244,157.108,82.244]},
  {fill: "#000000", points: [162.985,70.909,162.024,71.019,161.846,72.864,160.988,72.864,160.988,70.176,162.982,70.13]},
  {fill: "#000000", points: [121.153,87.515,120.722,88.132,121.6,87.515]},
  {fill: "#000000", points: [122.464,87.191,122.464,88.724,120.683,88.793,119.746,87.918,121.6,87.005,119.982,86.763,119.982,86.108,122.14,86.259,122.464,87.191]},
  {fill: "#000000", points: [131.152,86.782,131.152,88.419,130.288,88.419,129.885,86.316,129.309,88.419,128.451,88.419,128.451,85.732,130.204,85.666,131.152,86.782]},
  {fill: "#000000", points: [115.781,91.309,115.781,89.869,116.645,89.869,116.645,93.605,114.081,93.278,114.081,91.245,115.781,91.309]},
  {fill: "#000000", points: [115.216,93.051,115.781,92.263,115.216,91.476,114.651,92.263,115.216,93.051]},
  {fill: "#000000", points: [-8.559,118.269,-9.36,119.131,-8.625,119.317,-9.36,119.932,-9.36,122.005,-10.219,122.005,-10.647,119.317,-9.215,118.269]},
  {fill: "#000000", points: [11.957,125.234,10.997,125.345,10.819,127.19,9.961,127.19,9.961,124.502,11.955,124.456]},
  {fill: "#000000", points: [-10.28,130.236,-10.867,131.034,-10.28,131.829,-9.701,131.034,-10.28,130.236]},
  {fill: "#000000", points: [-10.28,129.621,-8.807,131.034,-10.28,132.444,-11.761,131.034,-10.28,129.621]},
  {fill: "#000000", points: [7.424,118.239,9.01,118.015,9.253,120.48,8.389,120.48,8.038,118.376,7.523,120.48,6.659,120.48,6.308,118.376,5.792,120.48,4.928,120.48,4.928,117.792,7.424,118.239]},
  {fill: "#000000", points: [16.822,121.3,16.822,122.062,17.708,122.062,17.708,122.677,16.822,122.677,17.631,124.75,16.172,124.539,15.536,122.677,15.961,121.3]},
  {fill: "#000000", points: [2.177,126.773,2.177,128.41,1.313,128.41,0.91,126.306,0.334,128.41,-0.525,128.41,-0.525,124.674,0.334,124.674,0.334,126.114,1.229,125.656,2.177,126.773]},
  {fill: "#000000", points: [14.96,118.213,12.949,118.46,14.831,118.739,14.831,119.4,13.613,119.634,12.074,118.224,13.564,116.811,14.96,118.213]},
  {fill: "#000000", points: [14.077,117.928,13.561,117.385,12.96,117.928]},
  {fill: "#000000", points: [21.173,117.508,22.204,117.508,23.507,119.966,23.507,117.508,24.382,117.508,24.382,121.09,23.351,121.09,22.048,118.633,22.048,121.09,21.173,121.09]},
  {fill: "#000000", points: [27.594,122.611,27.007,123.409,27.594,124.204,28.173,123.409,27.594,122.611]},
  {fill: "#000000", points: [27.594,121.996,29.067,123.409,27.594,124.819,26.113,123.409,27.594,121.996]},
  {fill: "#000000", points: [20.36,125.99,20.36,124.35,21.224,124.35,21.627,126.456,22.203,124.35,23.062,124.35,23.062,127.038,21.311,127.106,20.36,125.99]},
  {fill: "#000000", points: [38.181,122.503,38.181,124.14,37.317,124.14,36.914,122.036,36.338,124.14,35.48,124.14,35.48,121.452,37.233,121.386,38.181,122.503]},
  {fill: "#000000", points: [201.618,70.232,204.199,70.537,204.567,71.401,204.198,72.268,202.54,72.572,202.54,73.814,201.618,73.814]},
  {fill: "#000000", points: [202.54,70.901,203.053,71.903,203.615,71.4,203.053,70.901]},
  {fill: "#000000", points: [162.191,76.281,161.231,76.391,161.053,78.237,160.194,78.237,160.194,75.549,162.188,75.502]},
  {fill: "#000000", points: [138.733,98.82,138.146,99.618,138.733,100.414,139.311,99.618,138.733,98.82]},
  {fill: "#000000", points: [138.733,98.206,140.206,99.618,138.733,101.028,137.252,99.618,138.733,98.206]},
  {fill: "#000000", points: [131.072,106.66,131.93,106.66,131.93,109.299,130.493,110.409,131.072,109.298]},
  {fill: "#000000", points: [131.072,105.612,131.93,105.612,131.93,106.314,131.072,106.314]},
  {fill: "#000000", points: [118.511,111.96,116.501,112.207,118.382,112.487,118.382,113.148,117.164,113.381,115.626,111.971,117.115,110.559,118.511,111.96]},
  {fill: "#000000", points: [117.628,111.675,117.112,111.132,116.512,111.675]},
  {fill: "#000000", points: [122.4,103.542,122.4,104.241,120.921,104.804,122.4,105.363,122.4,106.065,120.436,105.84,120.436,103.764,122.4,103.542]},
  {fill: "#000000", points: [135.976,102.084,135.976,102.847,136.862,102.847,136.862,103.461,135.976,103.461,136.785,105.535,135.326,105.323,134.69,103.461,135.115,102.084]}
];

var replay = [
  {fill: "#ffffff", points: [20.976,30.041,25.612,27.914,29.379,23.803,31.272,18.521,31.084,13.21,28.822,8.065,25.196,4.536,20.097,2.512,14.896,2.698,8.739,6.107,5.182,11.823,4.516,12.537,3.356,12.235,3.142,11.09,4.876,7.411,7.464,4.277,10.77,1.9,14.449,0.501,20.561,0.315,26.212,2.551,30.633,6.842,33.192,12.734,33.328,19.345,31.159,25.081,27,29.649,21.462,32.232,15.366,32.43,10.063,30.434,5.578,26.351,2.832,20.586,3.009,19.625,4.154,19.212,7.347,25.055,11.115,28.469,15.884,30.239,20.976,30.041]},
  {fill: "#ffffff", points: [3.544,16.923,2.571,16.895,1.953,17.943,2.587,18.935,7.649,21.546,8.622,21.501,9.168,20.411,8.606,19.534]},
  {fill: "#ffffff", points: [3.995,18.341,3.892,17.367,2.785,16.86,1.963,17.586,0.063,23.126,0.166,24.098,1.274,24.605,2.096,23.878]}
];

var working = [
  {fill: "#ffffff", points: [2.657,2.494,1.6,3.505,1.6,6.036,2.657,7.046,5.299,7.046,6.353,6.034,6.353,3.504,5.297,2.494]},
  {fill: "#ffffff", points: [2.657,2.645,5.299,2.645,6.195,3.505,6.195,6.036,5.297,6.894,2.655,6.894,1.759,6.034,1.759,3.504,2.657,2.645]},
  {fill: "#ffffff", points: [5.693,3.765,4.426,2.891,3.362,4.227,4.758,5.246,5.693,3.766]},
  {fill: "#ffffff", points: [4.592,4.584,4.126,3.81,5.058,3.811,4.592,4.584]},
  {fill: "#ffffff", points: [3.716,5.388,2.867,4.805,2.132,5.721,3.088,6.425,3.716,5.388]},
  {fill: "#ffffff", points: [2.977,5.909,2.711,5.467,2.977,5.909]}
];

function drawPolyImage(polys, x, y, options) {
  const o = options || {};
  const g = o.graphics || global.g;
  const a = o.rotate || 0;
  const s = o.scale != null ? o.scale : 1;
  const ca = Math.cos(a), sa = Math.sin(a);
  for (let p of polys) {
    const pts = [];
    for (var i = 0; i < p.points.length; i += 2) {
      pts.push(p.points[i]*ca*s - p.points[i+1]*sa*s + x);
      pts.push(p.points[i+1]*ca*s + p.points[i]*sa*s + y);
    }
    if (p.fill) g.setColor(p.fill).fillPoly(pts);
    if (p.stroke) g.setColor(p.stroke).drawPoly(pts);
  }
}

function tick(x,a,b) {
  
  drawPolyImage(x, a, b);

}
g.clear();
 g.setColor(0,0,0);
g.fillRect(0,0,176,176); // clear app area
 g.setColor(0,1,0);
//tick(running,74,138);
tick(gardening,34,146);
tick(social,116,142);
tick(replay,5,95);


var bad_biome=require("Storage").read("bad-biome.png");
var good_biome=require("Storage").read("good-biome.png");
var weightlift=require("Storage").read("weigtlift.png");
var social=require("Storage").read("social.png");
var working=require("Storage").read("working.png");

g.drawImage(good_biome,128,0);
g.drawImage(weightlift,68,131);
g.drawImage(social,120,145);
g.drawImage(working,120,75);

g.setColor(0,1,0);
//g.drawCircle(88,98,54);

draw();
//g.drawImage(solid_block,88,146,40,146);
g.drawLine(88,176,44,139);
g.drawLine(88,176,136,139);
